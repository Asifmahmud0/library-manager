(()=>{"use strict";var e={n:t=>{var a=t&&t.__esModule?()=>t.default:()=>t;return e.d(a,{a}),a},d:(t,a)=>{for(var n in a)e.o(a,n)&&!e.o(t,n)&&Object.defineProperty(t,n,{enumerable:!0,get:a[n]})},o:(e,t)=>Object.prototype.hasOwnProperty.call(e,t)};const t=window.wp.element,a=window.wp.apiFetch;var n=e.n(a);const s=window.ReactJSXRuntime,l=({onEdit:e})=>{const[a,l]=(0,t.useState)([]),[r,i]=(0,t.useState)(!0);(0,t.useEffect)(()=>{o()},[]);const o=()=>{n()({path:"/library/v1/books"}).then(e=>{l(e),i(!1)}).catch(e=>console.error(e))};return r?(0,s.jsx)("p",{children:"Loading books..."}):(0,s.jsxs)("table",{className:"library-table widefat fixed striped",children:[(0,s.jsx)("thead",{children:(0,s.jsxs)("tr",{children:[(0,s.jsx)("th",{children:"Title"}),(0,s.jsx)("th",{children:"Author"}),(0,s.jsx)("th",{children:"Year"}),(0,s.jsx)("th",{children:"Status"}),(0,s.jsx)("th",{children:"Actions"})]})}),(0,s.jsx)("tbody",{children:0===a.length?(0,s.jsx)("tr",{children:(0,s.jsx)("td",{colSpan:"5",children:"No books found."})}):a.map(t=>(0,s.jsxs)("tr",{children:[(0,s.jsx)("td",{children:t.title}),(0,s.jsx)("td",{children:t.author}),(0,s.jsx)("td",{children:t.publication_year}),(0,s.jsx)("td",{children:(0,s.jsx)("span",{className:`status-${t.status}`,children:t.status})}),(0,s.jsxs)("td",{children:[(0,s.jsx)("button",{className:"button button-small",onClick:()=>e(t),children:"Edit"}),(0,s.jsx)("button",{className:"button button-small button-link-delete",onClick:()=>{return e=t.id,void(confirm("Are you sure you want to delete this book?")&&n()({path:`/library/v1/books/${e}`,method:"DELETE"}).then(()=>{o()}));var e},style:{marginLeft:"10px",color:"#a00"},children:"Delete"})]})]},t.id))})]})},r=({book:e,onSave:a,onCancel:l})=>{const r=!!e,[i,o]=(0,t.useState)({title:e?.title||"",author:e?.author||"",description:e?.description||"",publication_year:e?.publication_year||"",status:e?.status||"available"}),[d,c]=(0,t.useState)(!1),u=e=>{const{name:t,value:a}=e.target;o(e=>({...e,[t]:a}))};return(0,s.jsxs)("div",{className:"form-container",children:[(0,s.jsx)("h3",{children:r?"Edit Book":"Add New Book"}),(0,s.jsxs)("form",{onSubmit:t=>{t.preventDefault(),c(!0);const s=r?`/library/v1/books/${e.id}`:"/library/v1/books",l=r?"PUT":"POST";n()({path:s,method:l,data:i}).then(()=>{c(!1),a()}).catch(e=>{console.error(e),c(!1),alert("Error saving book.")})},children:[(0,s.jsxs)("div",{className:"form-group",children:[(0,s.jsx)("label",{children:"Title"}),(0,s.jsx)("input",{type:"text",name:"title",value:i.title,onChange:u,required:!0})]}),(0,s.jsxs)("div",{className:"form-group",children:[(0,s.jsx)("label",{children:"Author"}),(0,s.jsx)("input",{type:"text",name:"author",value:i.author,onChange:u})]}),(0,s.jsxs)("div",{className:"form-group",children:[(0,s.jsx)("label",{children:"Descriptionn"}),(0,s.jsx)("textarea",{name:"description",value:i.description,onChange:u})]}),(0,s.jsxs)("div",{className:"form-group",children:[(0,s.jsx)("label",{children:"Publication Year"}),(0,s.jsx)("input",{type:"number",name:"publication_year",value:i.publication_year,onChange:u})]}),(0,s.jsxs)("div",{className:"form-group",children:[(0,s.jsx)("label",{children:"Status"}),(0,s.jsxs)("select",{name:"status",value:i.status,onChange:u,children:[(0,s.jsx)("option",{value:"available",children:"Available"}),(0,s.jsx)("option",{value:"borrowed",children:"Borrowedd"}),(0,s.jsx)("option",{value:"unavailable",children:"Unavailable"})]})]}),(0,s.jsx)("button",{type:"submit",className:"button button-primary",disabled:d,children:d?"Saving...":"Save Book"}),(0,s.jsx)("button",{type:"button",className:"button",onClick:l,style:{marginLeft:"10px"},children:"Cancel"})]})]})},i=()=>{const[e,a]=(0,t.useState)("list"),[n,i]=(0,t.useState)(null);return(0,s.jsxs)("div",{className:"wrap",children:[(0,s.jsx)("h1",{className:"wp-heading-inline",children:"Library Manager"}),"list"===e&&(0,s.jsx)("button",{className:"page-title-action",onClick:()=>a("add"),children:"Add New"}),(0,s.jsx)("hr",{className:"wp-header-end"}),"list"===e&&(0,s.jsx)(l,{onEdit:e=>{i(e),a("edit")}}),("add"===e||"edit"===e)&&(0,s.jsx)(r,{book:n,onSave:()=>a("list"),onCancel:()=>{i(null),a("list")}})]})},o=document.getElementById("library-manager-app");o&&(0,t.render)((0,s.jsx)(i,{}),o)})();