(()=>{"use strict";var e={n:t=>{var a=t&&t.__esModule?()=>t.default:()=>t;return e.d(a,{a}),a},d:(t,a)=>{for(var s in a)e.o(a,s)&&!e.o(t,s)&&Object.defineProperty(t,s,{enumerable:!0,get:a[s]})},o:(e,t)=>Object.prototype.hasOwnProperty.call(e,t)};const t=window.wp.element,a=window.wp.apiFetch;var s=e.n(a);const n=window.ReactJSXRuntime,l=({onEdit:e})=>{const[a,l]=(0,t.useState)([]),[r,i]=(0,t.useState)(!0),[o,c]=(0,t.useState)("");(0,t.useEffect)(()=>{d()},[]),(0,t.useEffect)(()=>{const e=setTimeout(()=>{d()},500);return()=>clearTimeout(e)},[o]);const d=()=>{const e=o?`/library/v1/books?search=${o}`:"/library/v1/books";s()({path:e}).then(e=>{l(e),i(!1)}).catch(e=>console.error(e))};return(0,n.jsxs)("div",{children:[(0,n.jsx)("div",{className:"tablenav top",children:(0,n.jsxs)("div",{className:"alignleft actions",children:[(0,n.jsx)("input",{type:"search",placeholder:"Search by title or author...",value:o,onChange:e=>c(e.target.value),style:{height:"32px",margin:"0 10px 10px 0",minWidth:"250px"}}),o&&(0,n.jsx)("button",{className:"button",onClick:()=>c(""),children:"Clear"})]})}),r?(0,n.jsx)("p",{children:"Loading books..."}):(0,n.jsxs)("table",{className:"library-table widefat fixed striped",children:[(0,n.jsx)("thead",{children:(0,n.jsxs)("tr",{children:[(0,n.jsx)("th",{children:"Title"}),(0,n.jsx)("th",{children:"Author"}),(0,n.jsx)("th",{children:"Year"}),(0,n.jsx)("th",{children:"Status"}),(0,n.jsx)("th",{children:"Actions"})]})}),(0,n.jsx)("tbody",{children:0===a.length?(0,n.jsx)("tr",{children:(0,n.jsx)("td",{colSpan:"5",children:"No books found."})}):a.map(t=>(0,n.jsxs)("tr",{children:[(0,n.jsx)("td",{children:t.title}),(0,n.jsx)("td",{children:t.author}),(0,n.jsx)("td",{children:t.publication_year}),(0,n.jsx)("td",{children:(0,n.jsx)("span",{className:`status-${t.status}`,children:t.status})}),(0,n.jsxs)("td",{children:[(0,n.jsx)("button",{className:"button button-small",onClick:()=>e(t),children:"Edit"}),(0,n.jsx)("button",{className:"button button-small button-link-delete",onClick:()=>{return e=t.id,void(confirm("Are you sure you want to delete this book?")&&s()({path:`/library/v1/books/${e}`,method:"DELETE"}).then(()=>{d()}));var e},style:{marginLeft:"10px",color:"#a00"},children:"Delete"})]})]},t.id))})]})]})},r=({book:e,onSave:a,onCancel:l})=>{const r=!!e,[i,o]=(0,t.useState)({title:e?.title||"",author:e?.author||"",description:e?.description||"",publication_year:e?.publication_year||"",status:e?.status||"available"}),[c,d]=(0,t.useState)(!1),u=e=>{const{name:t,value:a}=e.target;o(e=>({...e,[t]:a}))};return(0,n.jsxs)("div",{className:"form-container",children:[(0,n.jsx)("h3",{children:r?"Edit Book":"Add New Book"}),(0,n.jsxs)("form",{onSubmit:t=>{t.preventDefault(),d(!0);const n=r?`/library/v1/books/${e.id}`:"/library/v1/books",l=r?"PUT":"POST";s()({path:n,method:l,data:i}).then(()=>{d(!1),a()}).catch(e=>{console.error(e),d(!1),alert("Error saving book.")})},children:[(0,n.jsxs)("div",{className:"form-group",children:[(0,n.jsx)("label",{children:"Title"}),(0,n.jsx)("input",{type:"text",name:"title",value:i.title,onChange:u,required:!0})]}),(0,n.jsxs)("div",{className:"form-group",children:[(0,n.jsx)("label",{children:"Author"}),(0,n.jsx)("input",{type:"text",name:"author",value:i.author,onChange:u})]}),(0,n.jsxs)("div",{className:"form-group",children:[(0,n.jsx)("label",{children:"Descriptionn"}),(0,n.jsx)("textarea",{name:"description",value:i.description,onChange:u})]}),(0,n.jsxs)("div",{className:"form-group",children:[(0,n.jsx)("label",{children:"Publication Year"}),(0,n.jsx)("input",{type:"number",name:"publication_year",value:i.publication_year,onChange:u})]}),(0,n.jsxs)("div",{className:"form-group",children:[(0,n.jsx)("label",{children:"Status"}),(0,n.jsxs)("select",{name:"status",value:i.status,onChange:u,children:[(0,n.jsx)("option",{value:"available",children:"Available"}),(0,n.jsx)("option",{value:"borrowed",children:"Borrowedd"}),(0,n.jsx)("option",{value:"unavailable",children:"Unavailable"})]})]}),(0,n.jsx)("button",{type:"submit",className:"button button-primary",disabled:c,children:c?"Saving...":"Save Book"}),(0,n.jsx)("button",{type:"button",className:"button",onClick:l,style:{marginLeft:"10px"},children:"Cancel"})]})]})},i=()=>{const[e,a]=(0,t.useState)("list"),[s,i]=(0,t.useState)(null);return(0,n.jsxs)("div",{className:"wrap",children:[(0,n.jsx)("h1",{className:"wp-heading-inline",children:"Library Manager"}),"list"===e&&(0,n.jsx)("button",{className:"page-title-action",onClick:()=>a("add"),children:"Add New"}),(0,n.jsx)("hr",{className:"wp-header-end"}),"list"===e&&(0,n.jsx)(l,{onEdit:e=>{i(e),a("edit")}}),("add"===e||"edit"===e)&&(0,n.jsx)(r,{book:s,onSave:()=>a("list"),onCancel:()=>{i(null),a("list")}})]})},o=document.getElementById("library-manager-app");o&&(0,t.render)((0,n.jsx)(i,{}),o)})();